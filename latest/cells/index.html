



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Package for designing CAD files for superconducting devices.">
      
      
      
        <meta name="author" content="Andrew Keller">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>Cells - Devices.jl</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../assets/Documenter.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#cell-api" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Devices.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon">î Œ</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Devices.jl
              </span>
              <span class="md-header-nav__topic">
                Cells
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/PainterQubits/Devices.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Devices.jl" class="md-nav__button md-logo">
      
        <i class="md-icon">î Œ</i>
      
    </a>
    Devices.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/PainterQubits/Devices.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../points/" title="Points" class="md-nav__link">
      Points
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../polygons/" title="Polygons" class="md-nav__link">
      Polygons
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Cells
      </label>
    
    <a href="./" title="Cells" class="md-nav__link md-nav__link--active">
      Cells
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cell-api" title="Cell API" class="md-nav__link">
    Cell API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-and-arrayed-cells" title="Referenced and arrayed cells" class="md-nav__link">
    Referenced and arrayed cells
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resolving-references" title="Resolving references" class="md-nav__link">
    Resolving references
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#miscellaneous" title="Miscellaneous" class="md-nav__link">
    Miscellaneous
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../paths/" title="Paths" class="md-nav__link">
      Paths
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../shapes/" title="Compound shapes" class="md-nav__link">
      Compound shapes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../render/" title="Rendering" class="md-nav__link">
      Rendering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fileio/" title="File formats" class="md-nav__link">
      File formats
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../LICENSE/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cell-api" title="Cell API" class="md-nav__link">
    Cell API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-and-arrayed-cells" title="Referenced and arrayed cells" class="md-nav__link">
    Referenced and arrayed cells
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resolving-references" title="Resolving references" class="md-nav__link">
    Resolving references
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#miscellaneous" title="Miscellaneous" class="md-nav__link">
    Miscellaneous
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/PainterQubits/Devices.jl/edit/master/docs/cells.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Cells</h1>
                
                <p>Cells are used to logically group polygons or references to other cells into a single entity. They can contain references to other cells or arrays of other cells. They also store polygons. Here is the definition of a <code>Cell</code>:</p>
<p><a id='Devices.Cells.Cell' href='#Devices.Cells.Cell'>#</a>
<strong><code>Devices.Cells.Cell</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>mutable struct Cell{S&lt;:Coordinate, T&lt;:Meta}
    name::String
    elements::Vector{CellPolygon{S,T}}
    refs::Vector{CellRef}
    create::DateTime
    Cell(x,y,z,t) = new(x, y, z, t)
    Cell(x,y,z) = new(x, y, z, now())
    Cell(x,y) = new(x, y, CellRef[], now())
    Cell(x) = new(x, Polygon{T}[], CellRef[], now())
    Cell() = begin
        c = new()
        c.elements = Polygon{T}[]
        c.refs = CellRef[]
        c.create = now()
        c
    end
end
</pre></div>


<p>A cell has a name and contains polygons and references to <code>CellArray</code> or <code>CellReference</code> objects. It also records the time of its own creation. As currently implemented it mirrors the notion of cells in GDS-II files.</p>
<p>To add elements, use <code>render!</code>. To add references, push them to <code>refs</code> field.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L149-L172' class='documenter-source'>source</a><br></p>
<p>The type parameter <code>S</code> of a <code>Cell{S,T}</code> object is used in two ways:</p>
<ol>
<li>Determine the units of the coordinates of all polygons in a cell, as well as origins and offset vectors of <a href="./#Devices.Cells.CellArray"><code>CellArray</code></a>s and <a href="./#Devices.Cells.CellReference"><code>CellReference</code></a>s.</li>
<li>Determine whether the cell will contain integer coordinates or floating-point coordinates. Currently, you cannot do a whole lot (particularly with regard to paths) if the cell has integer coordinates. However, they do have an inherent advantage because the coordinates are exact, and ultimately the GDS-II file represents shapes with integer coordinates. In the future, we intend to improve support for cells with integer coordinates.</li>
</ol>
<p>For instance, <code>Cell{typeof(1.0u"nm")}</code> matches a cell where the database unit is <code>nm</code> and polygons may have <code>Float64</code>-based coordinates (the type of <code>1.0</code> is <code>Float64</code>). Note that <code>Cell{typeof(2.0u"nm")}</code> does not mean the database unit is 2.0nm, because the returned type is the same. If that is intended, instead make a new unit such that one of that new unit is equal to 2nm. You can do this using the <code>@unit</code> macro in Unitful.</p>
<p>For most cases, if you want to use units, <code>Cell("my_cell_name", nm)</code> is a good way to construct a cell which will ultimately have all coordinates rounded to the nearest <code>nm</code> when exported into GDS-II. You can add polygons with whatever length units you want to such a cell, and the coordinates will be converted automatically to <code>nm</code>. You can change <code>nm</code> to <code>pm</code> or <code>fm</code> or whatever, but this will limit the pattern extent and probably doesn't make sense anyway.</p>
<p>If you don't want units, just construct the cell with a name only: <code>Cell("my_cell_name")</code> will return a <code>Cell{Float64}</code> object. In this case too, the ultimate database resolution is <code>1nm</code>; until exporting the cell into a GDS-II file, the coordinates are interpreted to be in units of <code>1Î¼m</code>. This behavior cannot be changed for cells without units.</p>
<p><a id='Cell-API-1'></a></p>
<h2 id="cell-api">Cell API</h2>
<p><a id='Devices.Cells.Cell-Tuple{AbstractString}' href='#Devices.Cells.Cell-Tuple{AbstractString}'>#</a>
<strong><code>Devices.Cells.Cell</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>Cell(name::AbstractString)
</pre></div>


<p>Convenience constructor for <code>Cell{Float64}</code>.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L445-L448' class='documenter-source'>source</a><br></p>
<p><a id='Devices.bounds-Union{Tuple{Cell{T,T1} where T1<:Meta}, Tuple{T}} where T<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T}' href='#Devices.bounds-Union{Tuple{Cell{T,T1} where T1<:Meta}, Tuple{T}} where T<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T}'>#</a>
<strong><code>Devices.bounds</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>bounds(cell::Cell{T}) where {T &lt;: Coordinate}
bounds(cell0::Cell, cell1::Cell, cell::Cell...)
</pre></div>


<p>Returns a <code>Rectangle</code> bounding box around all objects in a cell or cells. Returns a rectangle with zero width and height if the cell or cells are empty.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L511-L516' class='documenter-source'>source</a><br></p>
<p><a id='Devices.center-Tuple{Cell}' href='#Devices.center-Tuple{Cell}'>#</a>
<strong><code>Devices.center</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>center(cell::Cell)
</pre></div>


<p>Convenience method, equivalent to <code>center(bounds(cell))</code>. Returns the center of the bounding box of the cell.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L550-L554' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.name-Tuple{Cell}' href='#Devices.Cells.name-Tuple{Cell}'>#</a>
<strong><code>Devices.Cells.name</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>name(x::Cell)
</pre></div>


<p>Returns the name of the cell.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L707-L710' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.dbscale-Union{Tuple{Cell{T,T1} where T1<:Meta}, Tuple{T}} where T' href='#Devices.Cells.dbscale-Union{Tuple{Cell{T,T1} where T1<:Meta}, Tuple{T}} where T'>#</a>
<strong><code>Devices.Cells.dbscale</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>dbscale(c::Cell{T}) where {T}
</pre></div>


<p>Give the database scale for a cell. The database scale is the smallest increment of length that will be represented in the output CAD file.</p>
<p>For <code>Cell{T&lt;:Length}</code>, the database scale is <code>T(1)</code>. For floating-point lengths, this means that anything after the decimal point will be rounded off. For this reason, Cell{typeof(1.0nm)} is probably the most convenient type to work with.</p>
<p>The database scale of a <code>Cell{T&lt;:Real}</code> is assumed to be <code>1nm</code> (<code>1.0nm</code> if <code>T &lt;: AbstractFloat</code>) because insufficient information is provided to know otherwise.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L200-L213' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.dbscale-Tuple{Cell,Cell,Vararg{Cell,N} where N}' href='#Devices.Cells.dbscale-Tuple{Cell,Cell,Vararg{Cell,N} where N}'>#</a>
<strong><code>Devices.Cells.dbscale</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>dbscale(cell::Cell...)
</pre></div>


<p>Choose an appropriate database scale for a GDSII file given <a href="./#Devices.Cells.Cell"><code>Cell</code></a>s of different types. The smallest database scale of all cells considered is returned.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L216-L220' class='documenter-source'>source</a><br></p>
<p><a id='Referenced-and-arrayed-cells-1'></a></p>
<h2 id="referenced-and-arrayed-cells">Referenced and arrayed cells</h2>
<p>Cells can be arrayed or referenced within other cells for efficiency or to reduce display complexity.</p>
<p><a id='Devices.Cells.CellArray' href='#Devices.Cells.CellArray'>#</a>
<strong><code>Devices.Cells.CellArray</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>mutable struct CellArray{S,T} &lt;: CellRef{S,T}
    cell::T
    origin::Point{S}
    deltacol::Point{S}
    deltarow::Point{S}
    col::Int
    row::Int
    xrefl::Bool
    mag::Float64
    rot::Float64
end
</pre></div>


<p>Array of <code>cell</code> starting at <code>origin</code> with <code>row</code> rows and <code>col</code> columns, spanned by vectors <code>deltacol</code> and <code>deltarow</code>. Optional x-reflection <code>xrefl</code>, magnification factor <code>mag</code>, and rotation angle <code>rot</code> for the array as a whole. If an angle is given without units it is assumed to be in radians.</p>
<p>The type variable <code>T</code> is to avoid circular definitions with <code>Cell</code>.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L113-L131' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.CellArray-Union{Tuple{Cell{S,T} where T<:Meta}, Tuple{S}} where S<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T}' href='#Devices.Cells.CellArray-Union{Tuple{Cell{S,T} where T<:Meta}, Tuple{S}} where S<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T}'>#</a>
<strong><code>Devices.Cells.CellArray</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">CellArray</span><span class="o">(</span><span class="nt">x</span><span class="p">::</span><span class="nd">Cell</span><span class="p">{</span><span class="err">S</span><span class="p">}</span><span class="o">;</span> <span class="nt">kwargs</span><span class="o">...)</span> <span class="nt">where</span> <span class="p">{</span><span class="err">S</span> <span class="err">&lt;:</span> <span class="err">Coordinate</span><span class="p">}</span>
<span class="nt">CellArray</span><span class="o">(</span><span class="nt">x</span><span class="p">::</span><span class="nd">Cell</span><span class="p">{</span><span class="err">S</span><span class="p">}</span><span class="o">,</span> <span class="nt">origin</span><span class="p">::</span><span class="nd">Point</span><span class="p">{</span><span class="err">T</span><span class="p">}</span><span class="o">;</span> <span class="nt">kwargs</span><span class="o">...)</span> <span class="nt">where</span>
    <span class="p">{</span><span class="err">S</span> <span class="err">&lt;:</span> <span class="err">Coordinate,</span> <span class="err">T</span> <span class="err">&lt;:</span> <span class="err">Coordinate</span><span class="p">}</span>
<span class="nt">CellArray</span><span class="o">(</span><span class="nt">x</span><span class="o">,</span> <span class="nt">origin</span><span class="p">::</span><span class="nd">Point</span><span class="p">{</span><span class="err">T</span><span class="p">}</span><span class="o">;</span> <span class="nt">kwargs</span><span class="o">...)</span> <span class="nt">where</span> <span class="p">{</span><span class="err">T</span> <span class="err">&lt;:</span> <span class="err">Coordinate</span><span class="p">}</span>
</pre></div>


<p>Construct a <code>CellArray{float(T),typeof(x)}</code> object.</p>
<p>Keyword arguments specify the column vector, row vector, number of columns, number of rows, x-reflection, magnification factor, and rotation.</p>
<p>Synonyms are accepted for these keywords:</p>
<ul>
<li>Column vector <code>dc::Point{T}</code>: <code>:deltacol</code>, <code>:dcol</code>, <code>:dc</code>, <code>:vcol</code>, <code>:colv</code>, <code>:colvec</code>, <code>:colvector</code>, <code>:columnv</code>, <code>:columnvec</code>, <code>:columnvector</code></li>
<li>Row vector: <code>:deltarow</code>, <code>:drow</code>, <code>:dr</code>, <code>:vrow</code>, <code>:rv</code>, <code>:rowvec</code>, <code>:rowvector</code></li>
<li>Number of columns: <code>:nc</code>, <code>:numcols</code>, <code>:numcol</code>, <code>:ncols</code>, <code>:ncol</code></li>
<li>Number of rows: <code>:nr</code>, <code>:numrows</code>, <code>:numrow</code>, <code>:nrows</code>, <code>:nrow</code></li>
<li>X-reflection: <code>:xrefl</code>, <code>:xreflection</code>, <code>:refl</code>, <code>:reflect</code>, <code>:xreflect</code>, <code>:xmirror</code>, <code>:mirror</code></li>
<li>Magnification: <code>:mag</code>, <code>:magnification</code>, <code>:magnify</code>, <code>:zoom</code>, <code>:scale</code></li>
<li>Rotation: <code>:rot</code>, <code>:rotation</code>, <code>:rotate</code>, <code>:angle</code></li>
</ul>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L283-L305' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.CellArray-Tuple{Any,AbstractRange,AbstractRange}' href='#Devices.Cells.CellArray-Tuple{Any,AbstractRange,AbstractRange}'>#</a>
<strong><code>Devices.Cells.CellArray</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">CellArray</span><span class="o">(</span><span class="nt">x</span><span class="o">,</span> <span class="nt">c</span><span class="p">::</span><span class="nd">AbstractRange</span><span class="o">,</span> <span class="nt">r</span><span class="p">::</span><span class="nd">AbstractRange</span><span class="o">;</span> <span class="nt">kwargs</span><span class="o">...)</span>
</pre></div>


<p>Construct a <code>CellArray</code> based on ranges (probably <code>LinSpace</code> or <code>FloatRange</code>). <code>c</code> specifies column coordinates and <code>r</code> for the rows. Pairs from <code>c</code> and <code>r</code> specify the origins of the repeated cells. The extrema of the ranges therefore do not specify the extrema of the resulting <code>CellArray</code>'s bounding box; some care is required.</p>
<p>Keyword arguments specify x-reflection, magnification factor, and rotation, with synonyms allowed:</p>
<ul>
<li>X-reflection: <code>:xrefl</code>, <code>:xreflection</code>, <code>:refl</code>, <code>:reflect</code>, <code>:xreflect</code>, <code>:xmirror</code>, <code>:mirror</code></li>
<li>Magnification: <code>:mag</code>, <code>:magnification</code>, <code>:magnify</code>, <code>:zoom</code>, <code>:scale</code></li>
<li>Rotation: <code>:rot</code>, <code>:rotation</code>, <code>:rotate</code>, <code>:angle</code></li>
</ul>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L390-L406' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.CellReference' href='#Devices.Cells.CellReference'>#</a>
<strong><code>Devices.Cells.CellReference</code></strong> &mdash; <em>Type</em>.</p>
<div class="codehilite"><pre><span></span>mutable struct CellReference{S,T} &lt;: CellRef{S,T}
    cell::T
    origin::Point{S}
    xrefl::Bool
    mag::Float64
    rot::Float64
end
</pre></div>


<p>Reference to a <code>cell</code> positioned at <code>origin</code>, with optional x-reflection <code>xrefl</code>, magnification factor <code>mag</code>, and rotation angle <code>rot</code>. If an angle is given without units it is assumed to be in radians.</p>
<p>The type variable <code>T</code> is to avoid circular definitions with <code>Cell</code>.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L84-L97' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.CellReference-Union{Tuple{Cell{S,T} where T<:Meta}, Tuple{S}} where S<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T}' href='#Devices.Cells.CellReference-Union{Tuple{Cell{S,T} where T<:Meta}, Tuple{S}} where S<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T}'>#</a>
<strong><code>Devices.Cells.CellReference</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">CellReference</span><span class="o">(</span><span class="nt">x</span><span class="p">::</span><span class="nd">Cell</span><span class="p">{</span><span class="err">S</span><span class="p">}</span><span class="o">;</span> <span class="nt">kwargs</span><span class="o">...)</span> <span class="nt">where</span> <span class="p">{</span><span class="err">S</span> <span class="err">&lt;:</span> <span class="err">Coordinate</span><span class="p">}</span>
<span class="nt">CellReference</span><span class="o">(</span><span class="nt">x</span><span class="p">::</span><span class="nd">Cell</span><span class="p">{</span><span class="err">S</span><span class="p">}</span><span class="o">,</span> <span class="nt">origin</span><span class="p">::</span><span class="nd">Point</span><span class="p">{</span><span class="err">T</span><span class="p">}</span><span class="o">;</span> <span class="nt">kwargs</span><span class="o">...)</span> <span class="nt">where</span>
    <span class="p">{</span><span class="err">S</span> <span class="err">&lt;:</span> <span class="err">Coordinate,</span> <span class="err">T</span> <span class="err">&lt;:</span> <span class="err">Coordinate</span><span class="p">}</span>
<span class="nt">CellReference</span><span class="o">(</span><span class="nt">x</span><span class="o">,</span> <span class="nt">origin</span><span class="p">::</span><span class="nd">Point</span><span class="p">{</span><span class="err">T</span><span class="p">}</span><span class="o">;</span> <span class="nt">kwargs</span><span class="o">...)</span> <span class="nt">where</span> <span class="p">{</span><span class="err">T</span> <span class="err">&lt;:</span> <span class="err">Coordinate</span><span class="p">}</span>
</pre></div>


<p>Convenience constructor for <code>CellReference{float(T), typeof(x)}</code>.</p>
<p>Keyword arguments can specify x-reflection, magnification, or rotation. Synonyms are accepted, in case you forget the "correct keyword"...</p>
<ul>
<li>X-reflection: <code>:xrefl</code>, <code>:xreflection</code>, <code>:refl</code>, <code>:reflect</code>, <code>:xreflect</code>, <code>:xmirror</code>, <code>:mirror</code></li>
<li>Magnification: <code>:mag</code>, <code>:magnification</code>, <code>:magnify</code>, <code>:zoom</code>, <code>:scale</code></li>
<li>Rotation: <code>:rot</code>, <code>:rotation</code>, <code>:rotate</code>, <code>:angle</code></li>
</ul>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L224-L239' class='documenter-source'>source</a><br></p>
<p><a id='Devices.bounds-Union{Tuple{CellArray{T,Cell{S,U}}}, Tuple{U}, Tuple{T}, Tuple{S}} where U<:Devices.Meta where T<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T} where S<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T}' href='#Devices.bounds-Union{Tuple{CellArray{T,Cell{S,U}}}, Tuple{U}, Tuple{T}, Tuple{S}} where U<:Devices.Meta where T<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T} where S<:Union{Real, Union{Quantity{T,ð‹,U}, Level{L,S,Quantity{T,ð‹,U}} where S where L} where U where T}'>#</a>
<strong><code>Devices.bounds</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>bounds(ref::CellArray)
</pre></div>


<p>Returns a <code>Rectangle</code> bounding box around all objects in <code>ref</code>. The bounding box respects reflection, rotation, and magnification specified by <code>ref</code>.</p>
<p>Please do rewrite this method when feeling motivated... it is very inefficient.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L557-L563' class='documenter-source'>source</a><br></p>
<p><a id='Devices.bounds-Tuple{CellReference}' href='#Devices.bounds-Tuple{CellReference}'>#</a>
<strong><code>Devices.bounds</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>bounds(ref::CellReference)
</pre></div>


<p>Returns a <code>Rectangle</code> bounding box around all objects in <code>ref</code>. The bounding box respects reflection, rotation, and magnification specified by <code>ref</code>.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L583-L587' class='documenter-source'>source</a><br></p>
<p><a id='Base.copy-Tuple{CellReference}' href='#Base.copy-Tuple{CellReference}'>#</a>
<strong><code>Base.copy</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>copy(x::CellReference)
</pre></div>


<p>Creates a shallow copy of <code>x</code> (does not copy the referenced cell).</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L467-L470' class='documenter-source'>source</a><br></p>
<p><a id='Base.copy-Tuple{CellArray}' href='#Base.copy-Tuple{CellArray}'>#</a>
<strong><code>Base.copy</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>copy(x::CellArray)
</pre></div>


<p>Creates a shallow copy of <code>x</code> (does not copy the arrayed cell).</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L473-L476' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.name-Tuple{CellReference}' href='#Devices.Cells.name-Tuple{CellReference}'>#</a>
<strong><code>Devices.Cells.name</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>name(x::CellReference)
</pre></div>


<p>Returns the name of the referenced cell.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L719-L722' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.name-Tuple{CellArray}' href='#Devices.Cells.name-Tuple{CellArray}'>#</a>
<strong><code>Devices.Cells.name</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>name(x::CellArray)
</pre></div>


<p>Returns the name of the arrayed cell.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L713-L716' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.uniquename' href='#Devices.Cells.uniquename'>#</a>
<strong><code>Devices.Cells.uniquename</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>uniquename(str)
</pre></div>


<p>Given string input <code>str</code>, generate a unique name that bears some resemblance to <code>str</code>. Useful if programmatically making Cells and all of them will eventually be saved into a GDS-II file. The uniqueness is expected on a per-Julia session basis, so if you load an existing GDS-II file and try to save unique cells on top of that you may get an unlucky clash.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L70-L77' class='documenter-source'>source</a><br></p>
<p><a id='Resolving-references-1'></a></p>
<h2 id="resolving-references">Resolving references</h2>
<p>Sometimes it can be helpful to go between coordinate systems of cells and the cells they reference. This package provides methods to generate affine transforms to do this as easily as possible.</p>
<p><a id='CoordinateTransformations.transform-Tuple{Cell,Devices.Cells.CellRef}' href='#CoordinateTransformations.transform-Tuple{Cell,Devices.Cells.CellRef}'>#</a>
<strong><code>CoordinateTransformations.transform</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>transform(c::Cell, d::CellRef)
</pre></div>


<p>Given a Cell <code>c</code> containing <a href="./#Devices.Cells.CellReference"><code>CellReference</code></a> or <a href="./#Devices.Cells.CellArray"><code>CellArray</code></a> <code>d</code> in its tree of references, this function returns a <code>CoordinateTransformations.AffineMap</code> object that lets you translate from the coordinate system of <code>d</code> to the coordinate system of <code>c</code>.</p>
<p>If the <em>same exact</em> <code>CellReference</code> or <code>CellArray</code> (as in <code>===</code>, same address in memory) is included multiple times in the tree of references, then the resulting transform will be based on the first time it is encountered. The tree is traversed one level at a time to find the reference (optimized for shallow references).</p>
<p>Example: You want to translate (2.0,3.0) in the coordinate system of the referenced cell <code>d</code> to the coordinate system of <code>c</code>:</p>
<div class="codehilite"><pre><span></span>julia&gt; trans = transform(c,d)

julia&gt; trans(Point(2.0,3.0))
</pre></div>


<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L767-L788' class='documenter-source'>source</a><br></p>
<p>In some cases it may be desirable to resolve cell references or arrays into their corresponding polygons. This operation is called "flattening."</p>
<p><a id='Devices.Cells.flatten!' href='#Devices.Cells.flatten!'>#</a>
<strong><code>Devices.Cells.flatten!</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>flatten!(c::Cell, depth::Integer=-1)
</pre></div>


<p>Cell references and arrays up to a hierarchical <code>depth</code> are recursively flattened into polygons and added to cell <code>c</code>. The references and arrays that were flattened are then discarded. Deeper cell references and arrays are brought upwards and are not discarded. This function has no effect for <code>depth == 0</code>, and unlimited depth by default.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L632-L638' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.flatten' href='#Devices.Cells.flatten'>#</a>
<strong><code>Devices.Cells.flatten</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">flatten</span><span class="o">(</span><span class="nt">c</span><span class="p">::</span><span class="nd">Cell</span><span class="o">;</span> <span class="nt">depth</span><span class="p">::</span><span class="nd">Integer</span><span class="o">=</span><span class="nt">-1</span><span class="o">,</span> <span class="nt">name</span><span class="o">=</span><span class="nt">uniquename</span><span class="o">(</span><span class="s2">&quot;flatten&quot;</span><span class="o">))</span>
</pre></div>


<p>Cell references and arrays in <code>c</code> up to a hierarchical <code>depth</code> are recursively flattened into polygons and added to a new <code>Cell</code> with name <code>name</code>. The references and arrays that were flattened are then discarded. Deeper cell references and arrays are brought upwards and are not discarded. This function has no effect for <code>depth == 0</code>, and unlimited depth by default. The cell <code>c</code> remains unmodified.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L647-L654' class='documenter-source'>source</a><br></p>
<div class="codehilite"><pre><span></span><span class="nt">flatten</span><span class="o">(</span><span class="nt">c</span><span class="p">::</span><span class="nd">CellReference</span><span class="o">;</span> <span class="nt">depth</span><span class="p">::</span><span class="nd">Integer</span><span class="o">=</span><span class="nt">-1</span><span class="o">,</span> <span class="nt">name</span><span class="o">=</span><span class="nt">uniquename</span><span class="o">(</span><span class="s2">&quot;flatten&quot;</span><span class="o">))</span>
</pre></div>


<p>Cell reference <code>c</code> is recursively flattened into polygons up to a hierarchical <code>depth</code> and added to a new <code>Cell</code> with name <code>name</code>. The references and arrays that were flattened are then discarded. Deeper cell references and arrays are brought upwards and are not discarded. The cell reference <code>c</code> remains unmodified. The user should not pass <code>depth=0</code> as that will flatten with unlimited depth.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L667-L674' class='documenter-source'>source</a><br></p>
<div class="codehilite"><pre><span></span><span class="nt">flatten</span><span class="o">(</span><span class="nt">c</span><span class="p">::</span><span class="nd">CellArray</span><span class="o">;</span> <span class="nt">depth</span><span class="p">::</span><span class="nd">Integer</span><span class="o">=</span><span class="nt">-1</span><span class="o">,</span> <span class="nt">name</span><span class="o">=</span><span class="nt">uniquename</span><span class="o">(</span><span class="s2">&quot;flatten&quot;</span><span class="o">))</span>
</pre></div>


<p>Cell array <code>c</code> is recursively flattened into polygons up to a hierarchical <code>depth</code> and added to a new <code>Cell</code> with name <code>name</code>. The references and arrays that were flattened are then discarded. Deeper cell references and arrays are brought upwards and are not discarded. The cell reference <code>c</code> remains unmodified. The user should not pass <code>depth=0</code> as that will flatten with unlimited depth.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L686-L693' class='documenter-source'>source</a><br></p>
<p><a id='Miscellaneous-1'></a></p>
<h2 id="miscellaneous">Miscellaneous</h2>
<p>When saving cells to disk, keep in mind that cells should have unique names. We don't have an automatic renaming scheme implemented to avoid clashes. To help with this, we provide a function <a href="./#Devices.Cells.uniquename"><code>uniquename</code></a> to generate unique names based on human-readable prefixes.</p>
<p>When saving cells to disk, there will be a tree of interdependencies and logically one would prefer to write the leaf nodes of the tree before any dependent cells. These functions are used to traverse the tree and then find the optimal ordering.</p>
<p><a id='Devices.Cells.traverse!' href='#Devices.Cells.traverse!'>#</a>
<strong><code>Devices.Cells.traverse!</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>traverse!(a::AbstractArray, c::Cell, level=1)
</pre></div>


<p>Given a cell, recursively traverse its references for other cells and add to array <code>a</code> some tuples: <code>(level, c)</code>. <code>level</code> corresponds to how deep the cell was found, and <code>c</code> is the found cell.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L738-L743' class='documenter-source'>source</a><br></p>
<p><a id='Devices.Cells.order!' href='#Devices.Cells.order!'>#</a>
<strong><code>Devices.Cells.order!</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>order!(a::AbstractArray)
</pre></div>


<p>Given an array of tuples like that coming out of <a href="./#Devices.Cells.traverse!"><code>traverse!</code></a>, we sort by the <code>level</code>, strip the level out, and then retain unique entries. The aim of this function is to determine an optimal writing order when saving pattern data (although the GDS-II spec does not require cells to be in a particular order, there may be performance ramifications).</p>
<p>For performance reasons, this function modifies <code>a</code> but what you want is the returned result array.</p>
<p><a target='_blank' href='https://github.com/PainterQubits/Devices.jl/blob/c24495281abfa0b3f3d55b007625b934d46a7685/src/cells.jl#L751-L761' class='documenter-source'>source</a><br></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../polygons/" title="Polygons" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Polygons
              </span>
            </div>
          </a>
        
        
          <a href="../paths/" title="Paths" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Paths
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:".."}})</script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../assets/mathjaxhelper.js"></script>
      
    
    
      
    
  </body>
</html>